
{% extends 'pumas/base.html' %}
<body>
 
 
{% load staticfiles %}
{% block content %}


<script>


/* Formatting function for row details - modify as you need */
function format ( d ) {
    return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
        '<tr>'+
            '<td>'+d+'</td>'+
        '</tr>'+
    '</table>';
}

	$(document).ready(function() {
	    var table = $('#example').DataTable();
	    
	  {% for year in past_five_years %}
			$("#{{ year }}").click(function() {
						var column = table.column( 6 );
						var val ="";
						
						if ($("#{{ year }}").is(":checked")) {
						
									val = $.fn.dataTable.util.escapeRegex(
													$("#{{ year }}").val()
																			
										);
									
									 {% for year in past_five_years %}
							
											if($("#{{ year }}").is(":checked")){
												val = val +"|"+$.fn.dataTable.util.escapeRegex(
													$("#{{ year }}").val()
												);
											}
											
									{% endfor %}
									column.search(val, true, false).draw();
					
						} 
						else {
									 {% for Checkedyear in past_five_years %}
												if($("#{{ Checkedyear }}").is(":checked")){
													val = val+"|"+$.fn.dataTable.util.escapeRegex(
														$("#{{ Checkedyear }}").val()
													);
												}
									{% endfor %}
									
									val=val.substring(1);
									column.search(val, true, false ).draw();
									
						}	
			});
		{% endfor %}
		
		{% for content_type in content_types %}
			$("#{{ content_type }}").click(function() {
			
						var column = table.column( 5 );
						var val ="";
			
						if ($("#{{ content_type }}").is(":checked")) {
									
									val = $.fn.dataTable.util.escapeRegex(
											$("#{{ content_type }}").val()
																
									);
									
									
									{% for content_type in content_types %}
										if($("#{{ content_type }}").is(":checked")){
											val = val +"|"+$.fn.dataTable.util.escapeRegex(
												$("#{{ content_type }}").val()
											);
										}
							 		{% endfor %}
									 column.search(val, true, false).draw();
					
						} else {
								 {% for content_type in content_types %}
										if($("#{{ content_type }}").is(":checked")){
												val = val+"|"+$.fn.dataTable.util.escapeRegex(
														$("#{{ content_type }}").val()
												);
										}
								{% endfor %}
									
									val=val.substring(1);
									column.search(val, true, false ).draw();
						}	
			});
		{% endfor %}
	
	
                        
	   $('#example tbody').on('click', 'td.details-control', function () {
	        var tr = $(this).closest('tr');
	        var row = table.row( tr );
	 
	        if ( row.child.isShown() ) {
	            // This row is already open - close it
	            row.child.hide();
	            tr.removeClass('shown');
	        }
	        else {
	        	
	        	table.$('tr.selected').removeClass('selected');
	        	$(this).addClass('selected')
	        	
	        	var value = row.data()[0];
	            // Open this row
	            row.child(format(value) ).show();
	            tr.addClass('shown');
	        }
	    } );
	} );
</script>

  <div class="panel-group">
     <div class="panel panel-default">
     <div class="panel-heading">Search Results</div>
     <div class="panel-body">
	    <div class="row">
	    
	    	<div class="col-md-3" style="margin-top:2.5%;">
			    <div class="panel panel-success">
			      <div class="panel-heading">Filter results</div>
			      <div class="panel-body">
					
					Years
					<br />
					<br />
					<form action="demo_form.asp" method="get">
						{% for year in past_five_years %}
					  	<input type="checkbox" id="{{ year }}" name="{{ year }}" value="{{ year }}">{{ year }}<br>
					  	{% endfor %}
					  	<input type="checkbox" id="zero" value="" hidden>
					</form>
					<hr />
					Content type
					<br />
					<br />
					<form action="demo_form.asp" method="get">
						{% for content_type in content_types %}
					  	<input type="checkbox" id="{{ content_type }}" name="{{ content_type }}" value="{{ content_type }}">{{ content_type }}<br>
					  	{% endfor %}
					</form>
					<hr />
			      </div>
			    </div>
	    
	    	</div>
	    	
	    	
	    	<div class="col-md-9">

<table id="example"  class="table table-striped table-bordered" cellspacing="0" width="100%">
 
        <thead>
            <tr style="background:#e6f7dc">
	            <th style="display:none;"></th>
	            <th></th>
	            <th></th>
                <th>Doc Name</th>
                <th>Author</th>
                 <th>Category</th>
                <th>Year of publication</th>
            </tr>
        </thead>
        <tfoot >
            <tr style="background:#e6f7dc">
              	<th style="display:none;"></th>
              	<th></th>
              	<th></th>
                <th>Doc Name</th>
                <th>Author</th>
                <th>Category</th>
                <th>Year of publication</th>
            </tr>
        </tfoot>
      
        <tbody>
        {% if documents %}
        {% for document in documents %}
            <tr>
            	<td  style="display:none;">{{document.abstract}}</td>
            	<td class="details-control"><a href="#">abstract</a></td>
                <td><a href="{{document.document.url}}" target="blank"><img src="../static/images/adobe.png" width="35" height="35"/></a></td>
                <td>{{ document.title }}</td>	
                <td>{{ document.author }}</td>
                <td>{{ document.category }}</td>
                <td>{{ document.year_of_publication }}</td>
            </tr>
           {% endfor %}
          {% endif %}
        </tbody>
    </table>
			      </div>
			    </div>
	    	 </div>

	    </div>
      
      </div>
    </div>
   </div>
{% endblock content %}